var board=function(){function e(){var e=$(this),a=e.attr("class");if("attacker"==a)m?(m.attr("class","attacker"),m=null):(e.attr("class","attacker-select"),m=e);else if(m)if("empty"==a){google_apis.player_move(m.attr("id"),e.attr("id"))}else m.attr("class","attacker"),m=null}function a(){c.on("click",".row > div > div",e),google_apis.new_game(),d.addClass("hidden")}function n(){m&&(m.attr("class","attacker"),m=null)}function o(e){return 2==e||3==e?(2==e?(d.append("Player won!"),d.addClass("attacker-header")):(d.addClass("defender-header"),d.append("AI won!")),c.off(),d.removeClass("hidden"),!0):!1}function i(){c=$("#board");for(var a="",t=0;u>t;t++){for(var n="<div class='row'>",o=0;g>o;o++)n+="<div><div data-val='0' class='empty' id='"+t+","+o+"'></div></div>";n+="</div>",a+=n}c.append(a),c.on("click",".row > div > div",e)}function r(e,a,n,o){var i=document.getElementById(a),r=$(i);r.attr("class",p[0]);var l=document.getElementById(n),c=$(l);if(c.attr("class",p[e]),o&&o[0])for(var d=0;d<o.length;d++){f=o[d][0],t=o[d][1];var s=document.getElementById(f+","+t),u=$(s);u.attr("class",p[0])}}function l(e){e=e;for(var a=0;a<e.length;a++)for(var t=e[a].length,n=0;t>n;n++){var o=e[a][n],i=document.getElementById(a+","+n),r=$(i);r.attr("class",p[o])}}var c=$("#board"),d=$("#board_header"),s=$("#new_game");const u=9,g=9;var m=null;const p=["empty","attacker","defender","king"];return s.on("click",a),{empty_board:i,new_board:l,move:r,game_end:o,reset:n}}(),dialogs=function(){function e(){d.showModal()}function a(){s.showModal()}function t(){u.showModal()}function n(){d.close()}function o(){s.close()}function i(){u.close()}var r=$("#how"),l=$("#history"),c=$("#about"),d=document.getElementById("how-dialog"),s=document.getElementById("history-dialog"),u=document.getElementById("about-dialog");r.on("click",e),l.on("click",a),c.on("click",t),d.querySelector(".close").addEventListener("click",n),s.querySelector(".close").addEventListener("click",o),u.querySelector(".close").addEventListener("click",i)}(),google_apis=function(){function e(){gapi.client.hnefatafl.new_game().execute(function(e){o=e.key,board.new_board(JSON.parse(e.board)),n()})}function a(){gapi.client.hnefatafl.last_player_game().execute(function(a){if(404==a.code)e();else{o=a.key,board.new_board(JSON.parse(a.board));var t=parseInt(a.state);board.game_end(t)||1==t&&n()}})}function t(e,a){var t=e.split(","),i=a.split(",");try{gapi.client.hnefatafl.player_move({game_key:o,origin_row:t[0],origin_column:t[1],destination_row:i[0],destination_column:i[1]}).execute(function(e){board.reset(),console.log(e),e.code||(board.move(e.origin_value,e.origin,e.destination,"[]"!=e.captures?JSON.parse(e.captures.replace("(","[").replace(")","]")):null),board.game_end(parseInt(e.game_state))||n())})}catch(r){}}function n(){gapi.client.hnefatafl.ai_move({game_key:o}).execute(function(e){console.log(e),board.move(e.origin_value,e.origin,e.destination,"[]"!=e.captures?JSON.parse(e.captures.replace("(","[").replace(")","]")):null),board.game_end(parseInt(e.game_state))})}var o=null;return{new_game:e,player_move:t,ai_move:n,last_player_game:a}}(),google_auth=function(){function e(){gapi.client.load("oauth2","v2"),gapi.client.load("hnefatafl","v1",a,i)}function a(){t(immediate=!0),setTimeout(profile.enableLogin(),2e3)}function t(e){gapi.auth.authorize({client_id:"314272160250-ucrqg44c1oj9knlrfatqvqf1b3pm9819.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/userinfo.email",immediate:e},o)}function n(){return r}function o(e){gapi.client.oauth2.userinfo.get().execute(function(e){e.code||(profile.setLoggedIn(e.picture,e.name),r=!0,google_apis.last_player_game())})}const i="https://hnefatafl-game.appspot.com/_ah/api";var r=!1;return{loadModules:e,isAuthed:n,signin:t}}(),profile=function(){function e(){n.on("click",a),n.removeClass("hidden")}function a(){google_auth.signin(immediate=!1)}function t(e,a){o.html(a),o.removeClass("hidden"),n.addClass("hidden")}var n=$("#login"),o=$("#name");return{enableLogin:e,setLoggedIn:t}}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJvYXJkLmpzIiwiZGlhbG9ncy5qcyIsImdvb2dsZV9hcGkuanMiLCJnb29nbGVfYXV0aC5qcyIsInByb2ZpbGUuanMiXSwibmFtZXMiOlsiYm9hcmQiLCJvbkNsaWNrIiwiJGNlbGwiLCIkIiwidGhpcyIsInR5cGUiLCJhdHRyIiwiJHNlbGVjdGVkIiwiZ29vZ2xlX2FwaXMiLCJwbGF5ZXJfbW92ZSIsIm5ld19nYW1lIiwiJGJvYXJkIiwib24iLCIkYm9hcmRfaGVhZGVyIiwiYWRkQ2xhc3MiLCJyZXNldCIsImdhbWVfZW5kIiwiZ2FtZV9zdGF0ZSIsImFwcGVuZCIsIm9mZiIsInJlbW92ZUNsYXNzIiwiZW1wdHlfYm9hcmQiLCJ0YWJsZV9idWlsZGVyIiwicm93IiwiSEVJR0hUIiwicm93X2J1aWxkZXIiLCJjb2wiLCJXSURUSCIsIm1vdmUiLCJvcmlnaW5fdmFsdWUiLCJvcmlnaW4iLCJkZXN0aW5hdGlvbiIsImNhcHR1cmVzIiwib3IiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiJG9yIiwidHlwZU5hbWVzIiwiZGUiLCIkZGUiLCJpIiwibGVuZ3RoIiwiZiIsInQiLCJjYSIsIiRjYSIsIm5ld19ib2FyZCIsImNvbHVtbldpZHRoIiwidmFsIiwiJG5ld19nYW1lIiwiZGlhbG9ncyIsIm9wZW5Ib3ciLCJob3dfZGlhbG9nIiwic2hvd01vZGFsIiwib3Blbkhpc3RvcnkiLCJoaXN0b3J5X2RpYWxvZyIsIm9wZW5BYm91dCIsImFib3V0X2RpYWxvZyIsImNsb3NlSG93IiwiY2xvc2UiLCJjbG9zZUhpc3RvcnkiLCJjbG9zZUFib3V0IiwiJGhvdyIsIiRoaXN0b3J5IiwiJGFib3V0IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJnYXBpIiwiY2xpZW50IiwiaG5lZmF0YWZsIiwiZXhlY3V0ZSIsInJlc3BvbnNlIiwiS0VZIiwia2V5IiwiSlNPTiIsInBhcnNlIiwiYWlfbW92ZSIsImxhc3RfcGxheWVyX2dhbWUiLCJjb2RlIiwic3RhdGUiLCJwYXJzZUludCIsIm9yaWdpbnMiLCJzcGxpdCIsImRlc3RpbmF0aW9ucyIsImdhbWVfa2V5Iiwib3JpZ2luX3JvdyIsIm9yaWdpbl9jb2x1bW4iLCJkZXN0aW5hdGlvbl9yb3ciLCJkZXN0aW5hdGlvbl9jb2x1bW4iLCJjb25zb2xlIiwibG9nIiwicmVwbGFjZSIsImVyciIsImdvb2dsZV9hdXRoIiwibG9hZE1vZHVsZXMiLCJsb2FkIiwiYWZ0ZXJMb2FkZWQiLCJ1cmwiLCJzaWduaW4iLCJpbW1lZGlhdGUiLCJzZXRUaW1lb3V0IiwicHJvZmlsZSIsImVuYWJsZUxvZ2luIiwiYXV0aCIsImF1dGhvcml6ZSIsImNsaWVudF9pZCIsInNjb3BlIiwidXNlckF1dGhlZCIsImlzQXV0aGVkIiwic2lnbmVkaW4iLCJtb2RlIiwib2F1dGgyIiwidXNlcmluZm8iLCJnZXQiLCJyZXNwIiwic2V0TG9nZ2VkSW4iLCJwaWN0dXJlIiwibmFtZSIsIiRsb2dpbiIsIl9sb2dpbkNsaWNrIiwic3JjIiwiJG5hbWUiLCJodG1sIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFBQSxPQUFBLFdBb0JBLFFBQUFDLEtBQ0EsR0FBQUMsR0FBQUMsRUFBQUMsTUFDQUMsRUFBQUgsRUFBQUksS0FBQSxRQUVBLElBQUEsWUFBQUQsRUFDQUUsR0FDQUEsRUFBQUQsS0FBQSxRQUFBLFlBQ0FDLEVBQUEsT0FHQUwsRUFBQUksS0FBQSxRQUFBLG1CQUNBQyxFQUFBTCxPQUdBLElBQUFLLEVBQ0EsR0FBQSxTQUFBRixFQUNBLENBQUFHLFlBQUFDLFlBQ0FGLEVBQUFELEtBQUEsTUFDQUosRUFBQUksS0FBQSxXQUlBQyxHQUFBRCxLQUFBLFFBQUEsWUFDQUMsRUFBQSxLQUlBLFFBQUFHLEtBQ0FDLEVBQUFDLEdBQUEsUUFBQSxtQkFBQVgsR0FDQU8sWUFBQUUsV0FDQUcsRUFBQUMsU0FBQSxVQVFBLFFBQUFDLEtBQ0FSLElBQ0FBLEVBQUFELEtBQUEsUUFBQSxZQUNBQyxFQUFBLE1BSUEsUUFBQVMsR0FBQUMsR0FDQSxNQUFBLElBQUFBLEdBQUEsR0FBQUEsR0FDQSxHQUFBQSxHQUNBSixFQUFBSyxPQUFBLGVBQ0FMLEVBQUFDLFNBQUEscUJBR0FELEVBQUFDLFNBQUEsbUJBQ0FELEVBQUFLLE9BQUEsWUFFQVAsRUFBQVEsTUFDQU4sRUFBQU8sWUFBQSxXQUNBLElBRUEsRUFHQSxRQUFBQyxLQUVBVixFQUFBUixFQUFBLFNBRUEsS0FBQSxHQURBbUIsR0FBQSxHQUNBQyxFQUFBLEVBQUFDLEVBQUFELEVBQUFBLElBQUEsQ0FFQSxJQUFBLEdBREFFLEdBQUEsb0JBQ0FDLEVBQUEsRUFBQUMsRUFBQUQsRUFBQUEsSUFDQUQsR0FBQSw0Q0FBQUYsRUFBQSxJQUFBRyxFQUFBLGdCQUVBRCxJQUFBLFNBRUFILEdBQUFHLEVBR0FkLEVBQUFPLE9BQUFJLEdBRUFYLEVBQUFDLEdBQUEsUUFBQSxtQkFBQVgsR0FRQSxRQUFBMkIsR0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FJQSxHQUFBQyxHQUFBQyxTQUFBQyxlQUFBTCxHQUNBTSxFQUFBakMsRUFBQThCLEVBQ0FHLEdBQUE5QixLQUFBLFFBQUErQixFQUFBLEdBRUEsSUFBQUMsR0FBQUosU0FBQUMsZUFBQUosR0FDQVEsRUFBQXBDLEVBQUFtQyxFQUdBLElBRkFDLEVBQUFqQyxLQUFBLFFBQUErQixFQUFBUixJQUVBRyxHQUFBQSxFQUFBLEdBRUEsSUFBQSxHQUFBUSxHQUFBLEVBQUFBLEVBQUFSLEVBQUFTLE9BQUFELElBQUEsQ0FDQUUsRUFBQVYsRUFBQVEsR0FBQSxHQUNBRyxFQUFBWCxFQUFBUSxHQUFBLEVBQ0EsSUFBQUksR0FBQVYsU0FBQUMsZUFBQU8sRUFBQSxJQUFBQyxHQUNBRSxFQUFBMUMsRUFBQXlDLEVBQ0FDLEdBQUF2QyxLQUFBLFFBQUErQixFQUFBLEtBS0EsUUFBQVMsR0FBQTlDLEdBQ0FBLEVBQUFBLENBQ0EsS0FBQSxHQUFBdUIsR0FBQSxFQUFBQSxFQUFBdkIsRUFBQXlDLE9BQUFsQixJQUVBLElBQUEsR0FEQXdCLEdBQUEvQyxFQUFBdUIsR0FBQWtCLE9BQ0FmLEVBQUEsRUFBQXFCLEVBQUFyQixFQUFBQSxJQUFBLENBQ0EsR0FBQXNCLEdBQUFoRCxFQUFBdUIsR0FBQUcsR0FFQWlCLEVBQUFULFNBQUFDLGVBQUFaLEVBQUEsSUFBQUcsR0FFQXhCLEVBQUFDLEVBQUF3QyxFQUVBekMsR0FBQUksS0FBQSxRQUFBK0IsRUFBQVcsS0EzSUEsR0FBQXJDLEdBQUFSLEVBQUEsVUFDQVUsRUFBQVYsRUFBQSxpQkFDQThDLEVBQUE5QyxFQUFBLFlBRUEsTUFBQXFCLEdBQUEsRUFDQUcsRUFBQSxDQUVBLElBRUFwQixHQUFBLElBRUEsTUFBQThCLElBQ0EsUUFDQSxXQUNBLFdBQ0EsT0FrSkEsT0EvR0FZLEdBQUFyQyxHQUFBLFFBQUFGLElBZ0hBVyxZQUFBQSxFQUNBeUIsVUFBQUEsRUFDQWxCLEtBQUFBLEVBQ0FaLFNBQUFBLEVBQ0FELE1BQUFBLE1DeEtBbUMsUUFBQSxXQVVBLFFBQUFDLEtBQ0FDLEVBQUFDLFlBR0EsUUFBQUMsS0FDQUMsRUFBQUYsWUFHQSxRQUFBRyxLQUNBQyxFQUFBSixZQUdBLFFBQUFLLEtBQ0FOLEVBQUFPLFFBR0EsUUFBQUMsS0FDQUwsRUFBQUksUUFHQSxRQUFBRSxLQUNBSixFQUFBRSxRQTdCQSxHQUFBRyxHQUFBM0QsRUFBQSxRQUNBNEQsRUFBQTVELEVBQUEsWUFDQTZELEVBQUE3RCxFQUFBLFVBRUFpRCxFQUFBbEIsU0FBQUMsZUFBQSxjQUNBb0IsRUFBQXJCLFNBQUFDLGVBQUEsa0JBQ0FzQixFQUFBdkIsU0FBQUMsZUFBQSxlQTBCQTJCLEdBQUFsRCxHQUFBLFFBQUF1QyxHQUNBWSxFQUFBbkQsR0FBQSxRQUFBMEMsR0FDQVUsRUFBQXBELEdBQUEsUUFBQTRDLEdBRUFKLEVBQUFhLGNBQUEsVUFBQUMsaUJBQUEsUUFBQVIsR0FDQUgsRUFBQVUsY0FBQSxVQUFBQyxpQkFBQSxRQUFBTixHQUNBSCxFQUFBUSxjQUFBLFVBQUFDLGlCQUFBLFFBQUFMLE1DeENBckQsWUFBQSxXQUlBLFFBQUFFLEtBQ0F5RCxLQUFBQyxPQUFBQyxVQUFBM0QsV0FBQTRELFFBQUEsU0FBQUMsR0FFQUMsRUFBQUQsRUFBQUUsSUFDQXpFLE1BQUE4QyxVQUFBNEIsS0FBQUMsTUFBQUosRUFBQXZFLFFBQ0E0RSxNQUlBLFFBQUFDLEtBRUFWLEtBQUFDLE9BQUFDLFVBQUFRLG1CQUFBUCxRQUFBLFNBQUFDLEdBQ0EsR0FBQSxLQUFBQSxFQUFBTyxLQUNBcEUsUUFFQSxDQUNBOEQsRUFBQUQsRUFBQUUsSUFDQXpFLE1BQUE4QyxVQUFBNEIsS0FBQUMsTUFBQUosRUFBQXZFLE9BQ0EsSUFBQStFLEdBQUFDLFNBQUFULEVBQUFRLE1BQ0EvRSxPQUFBZ0IsU0FBQStELElBQ0EsR0FBQUEsR0FBQUgsT0FLQSxRQUFBbkUsR0FBQXFCLEVBQUFDLEdBQ0EsR0FBQWtELEdBQUFuRCxFQUFBb0QsTUFBQSxLQUNBQyxFQUFBcEQsRUFBQW1ELE1BQUEsSUFFQSxLQUVBZixLQUFBQyxPQUFBQyxVQUFBNUQsYUFDQTJFLFNBQUFaLEVBQ0FhLFdBQUFKLEVBQUEsR0FDQUssY0FBQUwsRUFBQSxHQUNBTSxnQkFBQUosRUFBQSxHQUNBSyxtQkFBQUwsRUFBQSxLQUNBYixRQUFBLFNBQUFDLEdBQ0F2RSxNQUFBZSxRQUNBMEUsUUFBQUMsSUFBQW5CLEdBQ0FBLEVBQUFPLE9BQ0E5RSxNQUFBNEIsS0FDQTJDLEVBQUExQyxhQUNBMEMsRUFBQXpDLE9BQ0F5QyxFQUFBeEMsWUFDQSxNQUFBd0MsRUFBQXZDLFNBQ0EwQyxLQUFBQyxNQUNBSixFQUFBdkMsU0FBQTJELFFBQUEsSUFBQSxLQUFBQSxRQUFBLElBQUEsTUFDQSxNQUVBM0YsTUFBQWdCLFNBQUFnRSxTQUFBVCxFQUFBdEQsY0FDQTJELE9BS0EsTUFBQWdCLEtBS0EsUUFBQWhCLEtBQ0FULEtBQUFDLE9BQUFDLFVBQUFPLFNBQ0FRLFNBQUFaLElBQ0FGLFFBQUEsU0FBQUMsR0FDQWtCLFFBQUFDLElBQUFuQixHQUNBdkUsTUFBQTRCLEtBQ0EyQyxFQUFBMUMsYUFDQTBDLEVBQUF6QyxPQUNBeUMsRUFBQXhDLFlBQ0EsTUFBQXdDLEVBQUF2QyxTQUNBMEMsS0FBQUMsTUFDQUosRUFBQXZDLFNBQUEyRCxRQUFBLElBQUEsS0FBQUEsUUFBQSxJQUFBLE1BQ0EsTUFFQTNGLE1BQUFnQixTQUFBZ0UsU0FBQVQsRUFBQXRELGVBN0VBLEdBQUF1RCxHQUFBLElBZ0ZBLFFBQ0E5RCxTQUFBQSxFQUNBRCxZQUFBQSxFQUNBbUUsUUFBQUEsRUFDQUMsaUJBQUFBLE1DdEZBZ0IsWUFBQSxXQU1BLFFBQUFDLEtBQ0EzQixLQUFBQyxPQUFBMkIsS0FDQSxTQUNBLE1BRUE1QixLQUFBQyxPQUFBMkIsS0FDQSxZQUNBLEtBQ0FDLEVBQ0FDLEdBSUEsUUFBQUQsS0FDQUUsRUFBQUMsV0FBQSxHQUNBQyxXQUFBQyxRQUFBQyxjQUFBLEtBSUEsUUFBQUosR0FBQUMsR0FDQWhDLEtBQUFvQyxLQUFBQyxXQUNBQyxVQUFBLDJFQUNBQyxNQUFBLGlEQUNBUCxVQUFBQSxHQUNBUSxHQUdBLFFBQUFDLEtBQ0EsTUFBQUMsR0FHQSxRQUFBRixHQUFBRyxHQUNBM0MsS0FBQUMsT0FBQTJDLE9BQUFDLFNBQUFDLE1BQUEzQyxRQUFBLFNBQUE0QyxHQUNBQSxFQUFBcEMsT0FDQXVCLFFBQUFjLFlBQUFELEVBQUFFLFFBQUFGLEVBQUFHLE1BQ0FSLEdBQUEsRUFFQXJHLFlBQUFxRSxzQkF4Q0EsS0FBQW9CLEdBQUEsNENBQ0EsSUFBQVksSUFBQSxDQTRDQSxRQUNBZixZQUFBQSxFQUNBYyxTQUFBQSxFQUNBVixPQUFBQSxNQ25EQUcsUUFBQSxXQUtBLFFBQUFDLEtBQ0FnQixFQUFBMUcsR0FBQSxRQUFBMkcsR0FDQUQsRUFBQWxHLFlBQUEsVUFFQSxRQUFBbUcsS0FDQTFCLFlBQUFLLE9BQUFDLFdBQUEsR0FLQSxRQUFBZ0IsR0FBQUssRUFBQUgsR0FDQUksRUFBQUMsS0FBQUwsR0FDQUksRUFBQXJHLFlBQUEsVUFDQWtHLEVBQUF4RyxTQUFBLFVBakJBLEdBQUF3RyxHQUFBbkgsRUFBQSxVQUVBc0gsRUFBQXRILEVBQUEsUUFpQkEsUUFDQW1HLFlBQUFBLEVBQ0FhLFlBQUFBIiwiZmlsZSI6InNjcmlwdHMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGJvYXJkID0gKGZ1bmN0aW9uKCkge1xuXG4gICB2YXIgJGJvYXJkID0gJChcIiNib2FyZFwiKTtcbiAgIHZhciAkYm9hcmRfaGVhZGVyID0gJChcIiNib2FyZF9oZWFkZXJcIik7XG4gICB2YXIgJG5ld19nYW1lID0gJChcIiNuZXdfZ2FtZVwiKTtcblxuICAgY29uc3QgSEVJR0hUID0gOTtcbiAgIGNvbnN0IFdJRFRIID0gOTtcblxuICAgdmFyIGJvYXJkO1xuXG4gICB2YXIgJHNlbGVjdGVkID0gbnVsbDtcblxuICAgY29uc3QgdHlwZU5hbWVzID0gW1xuICAgICAgJ2VtcHR5JyxcbiAgICAgICdhdHRhY2tlcicsXG4gICAgICAnZGVmZW5kZXInLFxuICAgICAgJ2tpbmcnXG4gICBdO1xuXG4gICBmdW5jdGlvbiBvbkNsaWNrKCkge1xuICAgICAgdmFyICRjZWxsID0gJCh0aGlzKTtcbiAgICAgIHZhciB0eXBlID0gJGNlbGwuYXR0cignY2xhc3MnKTtcblxuICAgICAgaWYodHlwZSA9PSBcImF0dGFja2VyXCIpIHtcbiAgICAgICAgIGlmKCRzZWxlY3RlZCkge1xuICAgICAgICAgICAgJHNlbGVjdGVkLmF0dHIoJ2NsYXNzJywnYXR0YWNrZXInKTtcbiAgICAgICAgICAgICRzZWxlY3RlZCA9IG51bGw7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICRjZWxsLmF0dHIoJ2NsYXNzJywnYXR0YWNrZXItc2VsZWN0Jyk7XG4gICAgICAgICAgICAkc2VsZWN0ZWQgPSAkY2VsbDtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2UgaWYoJHNlbGVjdGVkKXtcbiAgICAgICAgIGlmKHR5cGUgPT0gXCJlbXB0eVwiKSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gZ29vZ2xlX2FwaXMucGxheWVyX21vdmUoXG4gICAgICAgICAgICAgICAkc2VsZWN0ZWQuYXR0cignaWQnKSxcbiAgICAgICAgICAgICAgICRjZWxsLmF0dHIoJ2lkJylcbiAgICAgICAgICAgICk7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICRzZWxlY3RlZC5hdHRyKCdjbGFzcycsJ2F0dGFja2VyJyk7XG4gICAgICAgICAgICAkc2VsZWN0ZWQgPSBudWxsO1xuICAgICAgICAgfVxuICAgICAgfVxuICAgfVxuICAgZnVuY3Rpb24gbmV3X2dhbWUoKSB7XG4gICAgICAkYm9hcmQub24oJ2NsaWNrJywnLnJvdyA+IGRpdiA+IGRpdicsIG9uQ2xpY2spO1xuICAgICAgZ29vZ2xlX2FwaXMubmV3X2dhbWUoKTtcbiAgICAgICRib2FyZF9oZWFkZXIuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgfVxuICAgJG5ld19nYW1lLm9uKCdjbGljaycsbmV3X2dhbWUpO1xuXG4gICBmdW5jdGlvbiBjZWxsQ2xpY2sodGFyZ2V0LCBwYXJhbXMpIHtcblxuICAgfVxuXG4gICBmdW5jdGlvbiByZXNldCgpIHtcbiAgICAgIGlmKCRzZWxlY3RlZCkge1xuICAgICAgICAgJHNlbGVjdGVkLmF0dHIoJ2NsYXNzJywnYXR0YWNrZXInKTtcbiAgICAgICAgICRzZWxlY3RlZCA9IG51bGw7XG4gICAgICB9XG4gICB9XG5cbiAgIGZ1bmN0aW9uIGdhbWVfZW5kKGdhbWVfc3RhdGUpIHtcbiAgICAgIGlmKGdhbWVfc3RhdGUgPT0gMiB8fCBnYW1lX3N0YXRlID09IDMpIHtcbiAgICAgICAgIGlmKGdhbWVfc3RhdGUgPT0gMil7XG4gICAgICAgICAgICAkYm9hcmRfaGVhZGVyLmFwcGVuZChcIlBsYXllciB3b24hXCIpO1xuICAgICAgICAgICAgJGJvYXJkX2hlYWRlci5hZGRDbGFzcyhcImF0dGFja2VyLWhlYWRlclwiKTtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICRib2FyZF9oZWFkZXIuYWRkQ2xhc3MoXCJkZWZlbmRlci1oZWFkZXJcIik7XG4gICAgICAgICAgICAgJGJvYXJkX2hlYWRlci5hcHBlbmQoXCJBSSB3b24hXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICRib2FyZC5vZmYoKTtcbiAgICAgICAgICRib2FyZF9oZWFkZXIucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICB9XG5cbiAgIGZ1bmN0aW9uIGVtcHR5X2JvYXJkKCkge1xuXG4gICAgICAkYm9hcmQgPSAkKFwiI2JvYXJkXCIpO1xuICAgICAgdmFyIHRhYmxlX2J1aWxkZXIgPSBcIlwiO1xuICAgXHRmb3IodmFyIHJvdz0wOyByb3c8IEhFSUdIVDsgcm93Kyspe1xuICAgICAgICAgdmFyIHJvd19idWlsZGVyID0gXCI8ZGl2IGNsYXNzPSdyb3cnPlwiO1xuICAgXHRcdGZvcih2YXIgY29sPTA7IGNvbDwgV0lEVEg7IGNvbCsrKSB7XG4gICAgICAgICAgICByb3dfYnVpbGRlciArPSBcIjxkaXY+PGRpdiBkYXRhLXZhbD0nMCcgY2xhc3M9J2VtcHR5JyBpZD0nXCIgKyByb3cgKyBcIixcIiArIGNvbCArIFwiJz48L2Rpdj48L2Rpdj5cIjtcbiAgIFx0XHR9XG4gICAgICAgICByb3dfYnVpbGRlciArPSBcIjwvZGl2PlwiO1xuXG4gICAgICAgICB0YWJsZV9idWlsZGVyICs9IHJvd19idWlsZGVyO1xuICAgXHR9XG5cbiAgICAgICRib2FyZC5hcHBlbmQodGFibGVfYnVpbGRlcik7XG5cbiAgICAgICRib2FyZC5vbignY2xpY2snLCcucm93ID4gZGl2ID4gZGl2Jywgb25DbGljayk7XG5cbiAgIH1cblxuICAgZnVuY3Rpb24gZmFkZUluTmV3Q2xhc3Moc291cmNlLCBmcm9tX2NsYXNzLCB0b19jbGFzcykge1xuICAgICAgc291cmNlLnN3aXRjaENsYXNzKGZyb21fY2xhc3MsIHRvX2NsYXNzLCAxMDAwKTtcbiAgIH1cblxuICAgZnVuY3Rpb24gbW92ZShvcmlnaW5fdmFsdWUsIG9yaWdpbiwgZGVzdGluYXRpb24sIGNhcHR1cmVzKSB7XG5cblxuXG4gICAgICB2YXIgb3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChvcmlnaW4pO1xuICAgICAgdmFyICRvciA9ICQob3IpO1xuICAgICAgJG9yLmF0dHIoJ2NsYXNzJyx0eXBlTmFtZXNbMF0pO1xuXG4gICAgICB2YXIgZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkZXN0aW5hdGlvbik7XG4gICAgICB2YXIgJGRlID0gJChkZSk7XG4gICAgICAkZGUuYXR0cignY2xhc3MnLHR5cGVOYW1lc1tvcmlnaW5fdmFsdWVdKTtcblxuICAgICAgaWYoY2FwdHVyZXMgJiYgY2FwdHVyZXNbMF0pIHtcblxuICAgICAgICAgZm9yKHZhciBpPTA7IGk8IGNhcHR1cmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBmID0gY2FwdHVyZXNbaV1bMF07XG4gICAgICAgICAgICB0ID0gY2FwdHVyZXNbaV1bMV07XG4gICAgICAgICAgICB2YXIgY2EgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmICsgXCIsXCIgKyB0KTtcbiAgICAgICAgICAgIHZhciAkY2EgPSAkKGNhKTtcbiAgICAgICAgICAgICRjYS5hdHRyKCdjbGFzcycsdHlwZU5hbWVzWzBdKTtcbiAgICAgICAgIH1cbiAgICAgIH1cbiAgIH1cblxuICAgZnVuY3Rpb24gbmV3X2JvYXJkKGJvYXJkKSB7XG4gICAgICBib2FyZCA9IGJvYXJkO1xuICAgXHRmb3IodmFyIHJvdz0wOyByb3cgPCBib2FyZC5sZW5ndGg7IHJvdysrKXtcbiAgICAgICAgIHZhciBjb2x1bW5XaWR0aCA9IGJvYXJkW3Jvd10ubGVuZ3RoO1xuICAgXHRcdGZvcih2YXIgY29sPTA7IGNvbCA8IGNvbHVtbldpZHRoOyBjb2wrKykge1xuICAgICAgICAgICAgdmFyIHZhbCA9IGJvYXJkW3Jvd11bY29sXTtcblxuICAgICAgICAgICAgICAgdmFyIHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyb3cgKyBcIixcIiArIGNvbCk7XG5cbiAgICAgICAgICAgICAgIHZhciAkY2VsbCA9ICQodCk7XG5cbiAgICAgICAgICAgICAgICRjZWxsLmF0dHIoJ2NsYXNzJyx0eXBlTmFtZXNbdmFsXSk7XG5cbiAgIFx0XHR9XG4gICBcdH1cblxuICAgfVxuXG4gICBmdW5jdGlvbiBtYWtlX21vdmUoZnJvbV9yLCBmcm9tX2MsIHRvX3IsIHRvX2MsIGNhcHR1cmVzLCB2YWx1ZSkge1xuXG4gICAgICBib2FyZFtmcm9tX3JdW2Zyb21fY10gPSAwO1xuICAgICAgYm9hcmRbdG9fcl1bdG9fY10gPSB2YWx1ZTtcbiAgICAgICQoXCIjXCIgKyBmcm9tX3IgKyBcIixcIiArIGZyb21fYykuYXR0cignY2xhc3MnLCdlbXB0eScpO1xuICAgICAgJChcIiNcIiArIHRvX3IgKyBcIixcIiArIHRvX2MpLmF0dHIoJ2NsYXNzJyx0eXBlTmFtZXNbdmFsdWVdKTtcbiAgICAgIGZvcih2YXIgY2FwdHVyZSBpbiBjYXB0dXJlcykge1xuICAgICAgICAgdmFyIHIgPSBjYXB0dXJlWzBdO1xuICAgICAgICAgdmFyIGMgPSBjYXB0dXJlWzFdO1xuICAgICAgICAgYm9hcmRbcl1bY10gPSAwO1xuICAgICAgICAgJChcIiNcIiArIHIgKyBcIixcIiArIGMpLmF0dHIoJ2NsYXNzJywnZW1wdHknKTtcbiAgICAgIH1cblxuICAgfVxuXG4gICByZXR1cm4ge1xuICAgICAgZW1wdHlfYm9hcmQ6IGVtcHR5X2JvYXJkLFxuICAgICAgbmV3X2JvYXJkOiBuZXdfYm9hcmQsXG4gICAgICBtb3ZlOiBtb3ZlLFxuICAgICAgZ2FtZV9lbmQ6IGdhbWVfZW5kLFxuICAgICAgcmVzZXQ6IHJlc2V0XG4gICB9O1xufSkoKTtcbiIsInZhciBkaWFsb2dzID0gKGZ1bmN0aW9uKCl7XG5cbiAgIHZhciAkaG93ID0gJChcIiNob3dcIik7XG4gICB2YXIgJGhpc3RvcnkgPSAkKFwiI2hpc3RvcnlcIik7XG4gICB2YXIgJGFib3V0ID0gJChcIiNhYm91dFwiKTtcblxuICAgdmFyIGhvd19kaWFsb2cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaG93LWRpYWxvZycpO1xuICAgdmFyIGhpc3RvcnlfZGlhbG9nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hpc3RvcnktZGlhbG9nJyk7XG4gICB2YXIgYWJvdXRfZGlhbG9nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Fib3V0LWRpYWxvZycpO1xuXG4gICBmdW5jdGlvbiBvcGVuSG93KCl7XG4gICAgICBob3dfZGlhbG9nLnNob3dNb2RhbCgpO1xuICAgfVxuXG4gICBmdW5jdGlvbiBvcGVuSGlzdG9yeSgpIHtcbiAgICAgIGhpc3RvcnlfZGlhbG9nLnNob3dNb2RhbCgpO1xuICAgfVxuXG4gICBmdW5jdGlvbiBvcGVuQWJvdXQoKSB7XG4gICAgICBhYm91dF9kaWFsb2cuc2hvd01vZGFsKCk7XG4gICB9XG5cbiAgIGZ1bmN0aW9uIGNsb3NlSG93KCkge1xuICAgICAgaG93X2RpYWxvZy5jbG9zZSgpO1xuICAgfVxuXG4gICBmdW5jdGlvbiBjbG9zZUhpc3RvcnkoKSB7XG4gICAgICBoaXN0b3J5X2RpYWxvZy5jbG9zZSgpO1xuICAgfVxuXG4gICBmdW5jdGlvbiBjbG9zZUFib3V0KCkge1xuICAgICAgYWJvdXRfZGlhbG9nLmNsb3NlKCk7XG4gICB9XG5cbiAgICRob3cub24oJ2NsaWNrJywgb3Blbkhvdyk7XG4gICAkaGlzdG9yeS5vbignY2xpY2snLCBvcGVuSGlzdG9yeSk7XG4gICAkYWJvdXQub24oJ2NsaWNrJywgb3BlbkFib3V0KTtcblxuICAgaG93X2RpYWxvZy5xdWVyeVNlbGVjdG9yKCcuY2xvc2UnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlSG93KTtcbiAgIGhpc3RvcnlfZGlhbG9nLnF1ZXJ5U2VsZWN0b3IoJy5jbG9zZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VIaXN0b3J5KTtcbiAgIGFib3V0X2RpYWxvZy5xdWVyeVNlbGVjdG9yKCcuY2xvc2UnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlQWJvdXQpO1xuXG59KSgpO1xuIiwidmFyIGdvb2dsZV9hcGlzID0gKGZ1bmN0aW9uKCkge1xuXG4gICB2YXIgS0VZID0gbnVsbDtcblxuICAgZnVuY3Rpb24gbmV3X2dhbWUoKSB7XG4gICAgICBnYXBpLmNsaWVudC5obmVmYXRhZmwubmV3X2dhbWUoKS5leGVjdXRlKGZ1bmN0aW9uKHJlc3BvbnNlKXtcblxuICAgICAgICAgS0VZID0gcmVzcG9uc2Uua2V5O1xuICAgICAgICAgYm9hcmQubmV3X2JvYXJkKEpTT04ucGFyc2UocmVzcG9uc2UuYm9hcmQpKTtcbiAgICAgICAgIGFpX21vdmUoKTtcbiAgICAgIH0pO1xuICAgfVxuXG4gICBmdW5jdGlvbiBsYXN0X3BsYXllcl9nYW1lKCkge1xuXG4gICAgICBnYXBpLmNsaWVudC5obmVmYXRhZmwubGFzdF9wbGF5ZXJfZ2FtZSgpLmV4ZWN1dGUoZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgaWYocmVzcG9uc2UuY29kZSA9PSA0MDQpIHtcbiAgICAgICAgICAgIG5ld19nYW1lKCk7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIEtFWSA9IHJlc3BvbnNlLmtleTtcbiAgICAgICAgICAgIGJvYXJkLm5ld19ib2FyZChKU09OLnBhcnNlKHJlc3BvbnNlLmJvYXJkKSk7XG4gICAgICAgICAgICB2YXIgc3RhdGUgPSBwYXJzZUludChyZXNwb25zZS5zdGF0ZSk7XG4gICAgICAgICAgICBpZighYm9hcmQuZ2FtZV9lbmQoc3RhdGUpKVxuICAgICAgICAgICAgICAgaWYoc3RhdGUgPT0gMSkgYWlfbW92ZSgpO1xuICAgICAgICAgfVxuICAgICAgfSk7XG4gICB9XG5cbiAgIGZ1bmN0aW9uIHBsYXllcl9tb3ZlKG9yaWdpbiwgZGVzdGluYXRpb24pIHtcbiAgICAgIHZhciBvcmlnaW5zID0gb3JpZ2luLnNwbGl0KCcsJyk7XG4gICAgICB2YXIgZGVzdGluYXRpb25zID0gZGVzdGluYXRpb24uc3BsaXQoJywnKTtcblxuICAgICAgdHJ5XG4gICAgICB7XG4gICAgICAgICBnYXBpLmNsaWVudC5obmVmYXRhZmwucGxheWVyX21vdmUoe1xuICAgICAgICAgICAgXCJnYW1lX2tleVwiOiBLRVksXG4gICAgICAgICAgICBcIm9yaWdpbl9yb3dcIjogb3JpZ2luc1swXSxcbiAgICAgICAgICAgIFwib3JpZ2luX2NvbHVtblwiOiBvcmlnaW5zWzFdLFxuICAgICAgICAgICAgXCJkZXN0aW5hdGlvbl9yb3dcIjogZGVzdGluYXRpb25zWzBdLFxuICAgICAgICAgICAgXCJkZXN0aW5hdGlvbl9jb2x1bW5cIjogZGVzdGluYXRpb25zWzFdXG4gICAgICAgICB9KS5leGVjdXRlKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgIGJvYXJkLnJlc2V0KClcbiAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIGlmKCFyZXNwb25zZS5jb2RlKSAge1xuICAgICAgICAgICAgICAgYm9hcmQubW92ZShcbiAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLm9yaWdpbl92YWx1ZSxcbiAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLm9yaWdpbixcbiAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmRlc3RpbmF0aW9uLFxuICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuY2FwdHVyZXMgIT0gXCJbXVwiID9cbiAgICAgICAgICAgICAgICAgIEpTT04ucGFyc2UoXG4gICAgICAgICAgICAgICAgICAgICByZXNwb25zZS5jYXB0dXJlcy5yZXBsYWNlKCcoJywnWycpLnJlcGxhY2UoJyknLCddJylcbiAgICAgICAgICAgICAgICAgICk6IG51bGxcbiAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICBpZighYm9hcmQuZ2FtZV9lbmQocGFyc2VJbnQocmVzcG9uc2UuZ2FtZV9zdGF0ZSkpKSB7XG4gICAgICAgICAgICAgICAgICBhaV9tb3ZlKCk7XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNhdGNoKGVycikge1xuXG4gICAgICB9XG4gICB9XG5cbiAgICAgIGZ1bmN0aW9uIGFpX21vdmUoKSB7XG4gICAgICAgICBnYXBpLmNsaWVudC5obmVmYXRhZmwuYWlfbW92ZSh7XG4gICAgICAgICAgICBcImdhbWVfa2V5XCI6S0VZXG4gICAgICAgICB9KS5leGVjdXRlKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIGJvYXJkLm1vdmUoXG4gICAgICAgICAgICAgICByZXNwb25zZS5vcmlnaW5fdmFsdWUsXG4gICAgICAgICAgICAgICByZXNwb25zZS5vcmlnaW4sXG4gICAgICAgICAgICAgICByZXNwb25zZS5kZXN0aW5hdGlvbixcbiAgICAgICAgICAgICAgIHJlc3BvbnNlLmNhcHR1cmVzICE9IFwiW11cIiA/XG4gICAgICAgICAgICAgICBKU09OLnBhcnNlKFxuICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuY2FwdHVyZXMucmVwbGFjZSgnKCcsJ1snKS5yZXBsYWNlKCcpJywnXScpXG4gICAgICAgICAgICAgICApOiBudWxsXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYm9hcmQuZ2FtZV9lbmQocGFyc2VJbnQocmVzcG9uc2UuZ2FtZV9zdGF0ZSkpO1xuICAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICAgbmV3X2dhbWU6IG5ld19nYW1lLFxuICAgICAgICAgcGxheWVyX21vdmU6IHBsYXllcl9tb3ZlLFxuICAgICAgICAgYWlfbW92ZTogYWlfbW92ZSxcbiAgICAgICAgIGxhc3RfcGxheWVyX2dhbWU6IGxhc3RfcGxheWVyX2dhbWVcbiAgICAgIH07XG59KSgpO1xuIiwidmFyIGdvb2dsZV9hdXRoID0gKGZ1bmN0aW9uKCl7XG5cbiAgIC8vY29uc3QgdXJsID0gXCJodHRwOi8vbG9jYWxob3N0OjgwODAvX2FoL2FwaVwiO1xuICAgY29uc3QgdXJsID0gXCJodHRwczovL2huZWZhdGFmbC1nYW1lLmFwcHNwb3QuY29tL19haC9hcGlcIjtcbiAgIHZhciBzaWduZWRpbiA9IGZhbHNlO1xuXG4gICBmdW5jdGlvbiBsb2FkTW9kdWxlcygpe1xuICAgICAgZ2FwaS5jbGllbnQubG9hZChcbiAgICAgICAgICdvYXV0aDInLFxuICAgICAgICAgJ3YyJ1xuICAgICAgKTtcbiAgICAgIGdhcGkuY2xpZW50LmxvYWQoXG4gICAgICAgICAnaG5lZmF0YWZsJyxcbiAgICAgICAgICd2MScsXG4gICAgICAgICBhZnRlckxvYWRlZCxcbiAgICAgICAgIHVybFxuICAgICAgKTtcbiAgIH1cblxuICAgZnVuY3Rpb24gYWZ0ZXJMb2FkZWQoKSB7XG4gICAgICBzaWduaW4oaW1tZWRpYXRlID0gdHJ1ZSk7XG4gICAgICBzZXRUaW1lb3V0KHByb2ZpbGUuZW5hYmxlTG9naW4oKSwgMjAwMCk7XG5cbiAgIH1cblxuICAgZnVuY3Rpb24gc2lnbmluKGltbWVkaWF0ZSkge1xuICAgICAgZ2FwaS5hdXRoLmF1dGhvcml6ZSh7XG4gICAgICAgICBjbGllbnRfaWQ6ICczMTQyNzIxNjAyNTAtdWNycWc0NGMxb2o5a25scmZhdHF2cWYxYjNwbTk4MTkuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20nLFxuICAgICAgICAgc2NvcGU6ICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL3VzZXJpbmZvLmVtYWlsJyxcbiAgICAgICAgIGltbWVkaWF0ZTogaW1tZWRpYXRlXG4gICAgICB9LCB1c2VyQXV0aGVkKTtcbiAgIH1cblxuICAgZnVuY3Rpb24gaXNBdXRoZWQoKSB7XG4gICAgICByZXR1cm4gc2lnbmVkaW47XG4gICB9XG5cbiAgIGZ1bmN0aW9uIHVzZXJBdXRoZWQobW9kZSkge1xuICAgICAgdmFyIHJlcXVlc3QgPSBnYXBpLmNsaWVudC5vYXV0aDIudXNlcmluZm8uZ2V0KCkuZXhlY3V0ZShmdW5jdGlvbihyZXNwKSB7XG4gICAgICAgICBpZiAoIXJlc3AuY29kZSkge1xuICAgICAgICAgICAgcHJvZmlsZS5zZXRMb2dnZWRJbihyZXNwLnBpY3R1cmUsIHJlc3AubmFtZSk7XG4gICAgICAgICAgICBzaWduZWRpbiA9IHRydWU7XG4gICAgICAgICAgICAvL2dvb2dsZV9hcGlzLm5ld19nYW1lKGdvb2dsZV9hcGlzLmFpX21vdmUpO1xuICAgICAgICAgICAgZ29vZ2xlX2FwaXMubGFzdF9wbGF5ZXJfZ2FtZSgpO1xuICAgICAgICAgLy8gICBnb29nbGVfYXBpcy5haV9tb3ZlKCk7XG4gICAgICAgICAgfVxuICAgICB9KTtcbiAgIH1cbiAgIHJldHVybiB7XG4gICAgICBsb2FkTW9kdWxlczogbG9hZE1vZHVsZXMsXG4gICAgICBpc0F1dGhlZDogaXNBdXRoZWQsXG4gICAgICBzaWduaW46IHNpZ25pblxuICAgfTtcblxufSkoKTtcbiIsInZhciBwcm9maWxlID0gKGZ1bmN0aW9uKCkge1xuICAgdmFyICRsb2dpbiA9ICQoXCIjbG9naW5cIik7XG4gICAvL3ZhciAkcGljdHVyZSA9ICQoXCIjcGljdHVyZVwiKTtcbiAgIHZhciAkbmFtZSA9ICQoXCIjbmFtZVwiKTtcblxuICAgZnVuY3Rpb24gZW5hYmxlTG9naW4oKSB7XG4gICAgICAkbG9naW4ub24oJ2NsaWNrJywgX2xvZ2luQ2xpY2spO1xuICAgICAgJGxvZ2luLnJlbW92ZUNsYXNzKFwiaGlkZGVuXCIpO1xuICAgfVxuICAgZnVuY3Rpb24gX2xvZ2luQ2xpY2soKSB7XG4gICAgICBnb29nbGVfYXV0aC5zaWduaW4oaW1tZWRpYXRlID0gZmFsc2UpO1xuICAgfVxuICAgZnVuY3Rpb24gX2xvZ291dENsaWNrKCkge1xuICAgICAgLy9zaW5naW4oaW1tZWRpYXRlID0gZmFsc2UpO1xuICAgfVxuICAgZnVuY3Rpb24gc2V0TG9nZ2VkSW4oc3JjLCBuYW1lKSB7XG4gICAgICAkbmFtZS5odG1sKG5hbWUpO1xuICAgICAgJG5hbWUucmVtb3ZlQ2xhc3MoXCJoaWRkZW5cIik7XG4gICAgICAkbG9naW4uYWRkQ2xhc3MoXCJoaWRkZW5cIik7XG4gICB9XG4gICByZXR1cm4ge1xuICAgICAgZW5hYmxlTG9naW46IGVuYWJsZUxvZ2luLFxuICAgICAgc2V0TG9nZ2VkSW46IHNldExvZ2dlZEluXG4gICB9O1xufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
